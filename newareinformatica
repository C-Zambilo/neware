//clientes FORM5

procedure TForm5.imgSalvarClick(Sender: TObject);
begin
 if CNPJ.Text = ('') then
     begin
       ShowMessage('O campo CNPJ está vazio!');
       exit;
     end;
   if razao.Text = ('') then
     begin
       ShowMessage('O campo Razão Social está vazio!');
       exit;
     end;
    if fantasia.Text = ('') then
     begin
        ShowMessage('O campo Fantasia está vazio!');
       exit;
      end;
   if celular.Text = ('') then
     begin
       ShowMessage('O campo Celular está vazio!');
       exit;
      end;
    if email.Text = ('') then
      begin
             ShowMessage('O campo Email está vazio!');
        exit;
        end;
    if telefone.Text = ('') then
      begin
        ShowMessage('O campo Telefone está vazio!');
       exit;
     end;
    if contato.Text = ('') then
     begin
       ShowMessage('O campo Contato está vazio!');
       exit;
     end;
   if cep.Text = ('') then
     begin
            ShowMessage('O campo CEP está vazio!');
       exit;
    end;
   if logradouro.Text = ('') then
      begin
      ShowMessage('O campo Logradouro está vazio!');
       exit;
     end;
   if bairro.Text = ('') then
    begin
       ShowMessage('O campo Bairro está vazio!');
        exit;
      end;
   if uf.Text = ('') then
    begin
       ShowMessage('O campo UF está vazio!');
     exit;
    end;
   if ibge.Text = ('') then
     begin
        ShowMessage('O campo IBGE está vazio!');
      exit;
     end;
   if municipio.Text = ('') then
    begin
       ShowMessage('O campo Município está vazio!');
      exit;
      end;
  if complemento.Text = ('') then
    begin
      ShowMessage('O campo Complemento está vazio!');
      exit;
   end;
    if id.Text = ('') then
     begin
      ShowMessage('O campo Complemento está vazio!');
       exit;
     end;
 ///verificação de campos Finalizada
 ///
   with DataModule2 do
   BEGIN
    DataModule2.qrycliente.Active:=false;
    DataModule2.qrycliente.SQL.Clear;
    DataModule2.qrycliente.SQL.ADD('SELECT * FROM  TAB_CLIENTE');
    DataModule2.qrycliente.Active:=true;
         if  DataModule2.qrycliente.Locate('cli_codigo', id.Text,[]) then
         begin
           DataModule2.qrycliente.Active:=false;
           DataModule2.qrycliente.SQL.Clear;
           DataModule2.qrycliente.SQL.ADD('UPDATE TAB_CLIENTE SET cli_razao =:cli_razao, cli_fantasia =:cli_fantasia, cli_cgc =:cli_cgc, cli_inscricao =:cli_inscricao, cli_cep =:cli_cep, '+
           ' cli_logradouro =:cli_logradouro, cli_bairro =:cli_bairro, cli_estado =:cli_estado, cli_municipio =:cli_municipio, cli_ibge =:cli_ibge, cli_contato =:cli_contato, cli_telefone =:cli_telefone,'+
           ' cli_celular =:cli_celular, cli_email =:cli_email, cli_vendedor =:cli_vendedor, cli_cadastro =:cli_cadastro, cli_alteracao =:cli_alteracao, cli_vendedor2 =:cli_vendedor2, cli_ativo =:cli_ativo,'+
           ' cli_novo =:cli_novo, cli_vendedor3 =:cli_vendedor3, cli_vendedor4 =:cli_vendedor4, cli_complemento =:cli_complemento, cli_credito =:cli_credito, cli_ibge =:cli_ibge WHERE cli_codigo =:cli_id;');
          DataModule2.qrycliente.ParamByName('cli_razao').AsString:=AnsiUpperCase(RemoveAcentos(razao.Text));
          DataModule2.qrycliente.ParamByName('cli_fantasia').AsString:=AnsiUpperCase(RemoveAcentos(fantasia.Text));
          DataModule2.qrycliente.ParamByName('cli_cgc').AsString:=SomenteNumero(CNPJ.Text);
          DataModule2.qrycliente.ParamByName('cli_inscricao').AsString:=SomenteNumero(inscricao.Text);
          DataModule2.qrycliente.ParamByName('cli_cep').AsString:=SomenteNumero(cep.Text);
          DataModule2.qrycliente.ParamByName('cli_logradouro').AsString:=AnsiUpperCase(RemoveAcentos(logradouro.Text));
          DataModule2.qrycliente.ParamByName('cli_bairro').AsString:=AnsiUpperCase(RemoveAcentos(bairro.Text));
          DataModule2.qrycliente.ParamByName('cli_estado').AsString:=uf.Text;
          DataModule2.qrycliente.ParamByName ('cli_municipio').AsString:=AnsiUpperCase(RemoveAcentos(municipio.Text));
          DataModule2.qrycliente.ParamByName('cli_estado').AsString:=ibge.Text;
          DataModule2.qrycliente.ParamByName ('cli_contato').AsString:=SomenteNumero(contato.Text);
          DataModule2.qrycliente.ParamByName ('cli_telefone').AsString:=SomenteNumero(telefone.Text);
          DataModule2.qrycliente.ParamByName ('cli_celular').AsString:=SomenteNumero(celular.Text);
          DataModule2.qrycliente.ParamByName('cli_email').AsString:=email.Text;
          DataModule2.qrycliente.ParamByName('cli_vendedor').AsString:=vendedor1.Text;
          DataModule2.qrycliente.ParamByName('cli_cadastro').AsString:=data_cadastro.Text;
          DataModule2.qrycliente.ParamByName('cli_alteracao').AsString:=alterado.Text;
          DataModule2.qrycliente.ParamByName('cli_ativo').AsString:=ativo.Text;
          DataModule2.qrycliente.ParamByName('cli_novo').AsString:=novo.Text;
          DataModule2.qrycliente.ParamByName('cli_vendedor2').AsString:=vendedor2.Text;
          DataModule2.qrycliente.ParamByName('cli_vendedor3').AsString:=vendedor3.Text;
          DataModule2.qrycliente.ParamByName('cli_vendedor4').AsString:=vendedor4.Text;
          DataModule2.qrycliente.ParamByName('cli_complemento').AsString:=AnsiUpperCase(RemoveAcentos(complemento.Text));
          DataModule2.qrycliente.ParamByName('cli_credito').AsString:=credito.Text;
          DataModule2.qrycliente.ParamByName ('cli_ibge').AsString:=ibge.Text;
          DataModule2.qrycliente.ParamByName('cli_id').AsString:=id.Text;
          DataModule2.qrycliente.ExecSQL;
         end;

    DataModule2.qrycliente.Active:=false;
    DataModule2.qrycliente.SQL.Clear;
    DataModule2.qrycliente.SQL.ADD('SELECT * FROM  TAB_CLIENTE');
    DataModule2.qrycliente.Active:=true;
    //CASO NÃO VEJA QUE O ID ESTÁ INSERIDO NA BASE...
         if not DataModule2.qrycliente.Locate('cli_codigo', id.Text) then
        begin
           DataModule2.qrycliente.Active:=false;
           DataModule2.qrycliente.SQL.Clear;
           DataModule2.qrycliente.SQL.ADD('Insert Into TAB_CLIENTE (cli_codigo, cli_razao, cli_fantasia, cli_tipo, cli_cgc, cli_inscricao, cli_cep, cli_logradouro, cli_bairro, cli_estado,'+
           ' cli_municipio, cli_ibge, cli_contato, cli_telefone, cli_celular, cli_email, cli_vendedor, cli_cadastro, cli_alteracao, cli_vendedor2, cli_ativo, cli_novo, cli_vendedor3, cli_vendedor4, cli_complemento, cli_credito)');
           DataModule2.qrycliente.SQL.ADD('values (:cli_codigo, :cli_razao, :cli_fantasia, :cli_tipo, :cli_cgc, :cli_inscricao, :cli_cep, :cli_logradouro, :cli_bairro, :cli_estado, '+
           ' :cli_municipio, :cli_ibge, :cli_contato, :cli_telefone, :cli_celular, :cli_email, :cli_vendedor, :cli_cadastro, :cli_alteracao, :cli_vendedor2, :cli_ativo, :cli_novo, :cli_vendedor3, :cli_vendedor4, :cli_complemento, :cli_credito)');
           DataModule2.qrycliente.ParamByName('cli_codigo').AsString:=id.text;
           DataModule2.qrycliente.ParamByName('cli_razao').AsString:=AnsiUpperCase(RemoveAcentos(razao.Text));
           DataModule2.qrycliente.ParamByName('cli_fantasia').AsString:=AnsiUpperCase(RemoveAcentos(fantasia.Text));
           DataModule2.qrycliente.ParamByName('cli_tipo').AsString:=tipo.Items[tipo.ItemIndex];
           DataModule2.qrycliente.ParamByName('cli_cgc').AsString:=SomenteNumero(CNPJ.Text);
           DataModule2.qrycliente.ParamByName('cli_inscricao').AsString:=SomenteNumero(inscricao.Text);
           DataModule2.qrycliente.ParamByName('cli_cep').AsString:=SomenteNumero(cep.Text);
           DataModule2.qrycliente.ParamByName('cli_logradouro').AsString:=AnsiUpperCase(RemoveAcentos(logradouro.Text));
           DataModule2.qrycliente.ParamByName('cli_bairro').AsString:=AnsiUpperCase(RemoveAcentos(bairro.Text));
           DataModule2.qrycliente.ParamByName('cli_estado').AsString:=uf.Text;
           DataModule2.qrycliente.ParamByName ('cli_municipio').AsString:=AnsiUpperCase(RemoveAcentos(municipio.Text));
           DataModule2.qrycliente.ParamByName('cli_estado').AsString:=ibge.Text;
           DataModule2.qrycliente.ParamByName ('cli_contato').AsString:=SomenteNumero(contato.Text);
           DataModule2.qrycliente.ParamByName ('cli_telefone').AsString:=SomenteNumero(telefone.Text);
           DataModule2.qrycliente.ParamByName ('cli_celular').AsString:=SomenteNumero(celular.Text);
           DataModule2.qrycliente.ParamByName('cli_email').AsString:=email.Text;
           DataModule2.qrycliente.ParamByName('cli_vendedor').AsString:=vendedor1.Text;
           DataModule2.qrycliente.ParamByName('cli_cadastro').AsString:=data_cadastro.Text;
           DataModule2.qrycliente.ParamByName('cli_alteracao').AsString:=alterado.Text;
           DataModule2.qrycliente.ParamByName('cli_ativo').AsString:=ativo.Text;
           DataModule2.qrycliente.ParamByName('cli_novo').AsString:=novo.Text;
           DataModule2.qrycliente.ParamByName('cli_vendedor2').AsString:=vendedor2.Text;
           DataModule2.qrycliente.ParamByName('cli_vendedor3').AsString:=vendedor3.Text;
           DataModule2.qrycliente.ParamByName('cli_vendedor4').AsString:=vendedor4.Text;
           DataModule2.qrycliente.ParamByName('cli_complemento').AsString:=AnsiUpperCase(RemoveAcentos(complemento.Text));
           DataModule2.qrycliente.ParamByName('cli_credito').AsString:=credito.Text;
           DataModule2.qrycliente.ParamByName ('cli_ibge').AsString:=ibge.Text;
           DataModule2.qrycliente.EXECSQL;
        end

//             if DataModule2.qrycliente.Locate('cli_razao', id.Text,[]) then
//         begin
//          ShowMessage('O cliente ja está cadastrado');
//         end;

  ELSE
      ShowMessage('O Novo Cliente foi inserido com sucesso em sua base!'+
                 'sincronize-o para enviá-lo a base do servidor');

    CNPJ.ReadOnly:= false;
    credito.Text:='3.000';


  end;
end;
